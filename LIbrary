A) CREATE SCHEMA LIB; 
USE LIB; 
CREATE TABLE PUBLISHER ( 
    PUBLISHER_ID INT PRIMARY KEY, 
    PNAME VARCHAR(255), 
    CITY VARCHAR(100), 
    COUNTRY VARCHAR(100) 
); 
CREATE TABLE AUTHOR ( 
    AUTHOR_ID INT PRIMARY KEY, 
    ANAME VARCHAR(255), 
    CITY VARCHAR(100), 
    COUNTRY VARCHAR(100) 
); 

CREATE TABLE BOOK ( 
    BOOK_ID INT PRIMARY KEY, 
    TITLE VARCHAR(255), 
    YEAR_OF_PUBLICATION INT, 
    AUTHOR_ID INT, 
    PUBLISHER_ID INT, 
    FOREIGN KEY (AUTHOR_ID) REFERENCES AUTHOR(AUTHOR_ID), 
    FOREIGN KEY (PUBLISHER_ID) REFERENCES 
PUBLISHER(PUBLISHER_ID) 
); 

CREATE TABLE BORDER ( 
    ORDER_ID INT PRIMARY KEY, 
    BOOK_ID INT, 
    QUANTITY INT, 
    FOREIGN KEY (BOOK_ID) REFERENCES BOOK(BOOK_ID) 
); 
B) INSERT INTO PUBLISHER (PUBLISHER_ID, PNAME, CITY, 
COUNTRY) 
VALUES (1, 'PUBLISHERA', 'CITYA', 'COUNTRYA'); 
INSERT INTO PUBLISHER (PUBLISHER_ID, PNAME, CITY, COUNTRY) 
VALUES (2, 'PUBLISHERB', 'CITYB', 'COUNTRYB'); 


INSERT INTO AUTHOR (AUTHOR_ID, ANAME, CITY, COUNTRY) 
VALUES (1, 'AUTHORA', 'CITYX', 'COUNTRYX'); 
INSERT INTO AUTHOR (AUTHOR_ID, ANAME, CITY, COUNTRY) 
VALUES (2, 'AUTHORB', 'CITYY', 'COUNTRYY'); 

INSERT INTO BOOK (BOOK_ID, TITLE, YEAR_OF_PUBLICATION, 
AUTHOR_ID, PUBLISHER_ID) 
VALUES (1, 'BOOKA', 2010, 1, 1); 

INSERT INTO BOOK (BOOK_ID, TITLE, YEAR_OF_PUBLICATION, 
AUTHOR_ID, PUBLISHER_ID) 
VALUES (2, 'BOOKB', 2011, 2, 2); 


INSERT INTO BOOK (BOOK_ID, TITLE, YEAR_OF_PUBLICATION, 
AUTHOR_ID, PUBLISHER_ID) 
VALUES (3, 'BOOKC', 2011, 1, 1); 
INSERT INTO BOOK (BOOK_ID, TITLE, YEAR_OF_PUBLICATION, 
AUTHOR_ID, PUBLISHER_ID) 
VALUES (4, 'BOOKC', 2014, 1, 1); 
INSERT INTO BOOK (BOOK_ID, TITLE, YEAR_OF_PUBLICATION, 
AUTHOR_ID, PUBLISHER_ID) 
VALUES (5, 'BOOKC', 2015, 1, 1); 

INSERT INTO BORDER (ORDER_ID, BOOK_ID, QUANTITY) 
VALUES (101, 1, 5); 

INSERT INTO BORDER (ORDER_ID, BOOK_ID, QUANTITY) 
VALUES (102, 2, 3); 

INSERT INTO BORDER (ORDER_ID, BOOK_ID, QUANTITY) 
VALUES (103, 3, 2); 

C)	SELECT A.ANAME AS AUTHOR_NAME,  
       (SELECT COUNT(*) FROM BOOK B WHERE B.AUTHOR_ID = 
A.AUTHOR_ID) AS NUM_BOOKS_PUBLISHED 
FROM AUTHOR A 
ORDER BY NUM_BOOKS_PUBLISHED DESC; 
 


D)	SELECT B.TITLE
FROM BOOK B, PUBLISHER P  
WHERE B.PUBLISHER_ID = P.PUBLISHER_ID AND 
B.YEAR_OF_PUBLICATION = 2011 ; 
 


E)	DELIMITER // 

CREATE TRIGGER CHECK_CURRENT_YEAR 
BEFORE INSERT ON BOOK 
FOR EACH ROW 
BEGIN 
    IF NEW.YEAR_OF_PUBLICATION > 2014 THEN 
        SIGNAL SQLSTATE '45000' 
        SET MESSAGE_TEXT = 'INVALID YEAR OF PUBLICATION: FUTURE YEAR NOT ALLOWED'; 
    END IF; 
END; 
// 

DELIMITER ;

DROP TRIGGER IF EXISTS CHECK_CURRENT_YEAR; 
DELIMITER // 

 

F)  CREATE PROCEDURE LIST_BOOKS_BY_AUTHOR_AND_YEAR(IN 
AUTHOR_NAME VARCHAR(255), IN PUBLICATION_YEAR INT) 
BEGIN 
    SELECT TITLE AS BOOK_TITLE 
    FROM BOOK 
    WHERE AUTHOR_ID = (SELECT AUTHOR_ID FROM AUTHOR WHERE ANAME = AUTHOR_NAME) 
    AND YEAR_OF_PUBLICATION = PUBLICATION_YEAR; 
END; 
// 

DELIMITER ;
CALL LIST_BOOKS_BY_AUTHOR_AND_YEAR('AUTHORA',2011); 
 


